					---DATABASE SYSTEM---
				LAB 05 : Working With JOINs
Name: M.KAMIL				SECTION-A				CMS ID: 021-19-0039
====================================================================================================
Q#01:
	SELECT E.FIRST_NAME,E.LAST_NAME,E.DEPARTMENT_ID,D.DEPARTMENT_NAME
FROM employees E JOIN departments D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID;
Q#02:
	 SELECT E.FIRST_NAME,E.LAST_NAME,E.JOB_ID,E.DEPARTMENT_ID,D.DEPARTM
ENT_NAME FROM employees E JOIN departments D ON E.DEPARTMENT_ID = D.DEPARTMENT_I
D JOIN locations L ON L.LOCATION_ID = D.LOCATION_ID WHERE L.city = 'London';
Q#03:
	 SELECT E.FIRST_NAME,E.LAST_NAME,E.JOB_ID,D.DEPARTMENT_NAME,L.CITY,
L.STATE_PROVINCE FROM employees E JOIN departments D ON E.DEPARTMENT_ID = D.DEPA
RTMENT_ID JOIN locations L ON L.LOCATION_ID = D.LOCATION_ID;
Q#04:
	 SELECT e1.EMPLOYEE_ID,e1.LAST_NAME,e2.MANAGER_ID,e2.LAST_NAME FROM
 employees e1 JOIN employees e2 ON e1.MANAGER_ID = e2.MANAGER_ID;
Q#05:
	 SELECT e2.FIRST_NAME,e2.LAST_NAME,e2.HIRE_DATE FROM employees e1 J
OIN employees e2 ON e1.LAST_NAME = 'Jones' WHERE e1.HIRE_DATE < e2.HIRE_DATE;
Q#06:
	SELECT DEPARTMENT_NAME AS NAME,COUNT(*) AS NUMBER FROM departments
 INNER JOIN employees ON employees.DEPARTMENT_ID = departments.DEPARTMENT_ID GRO
UP BY departments.DEPARTMENT_ID, DEPARTMENT_NAME ORDER BY DEPARTMENT_NAME;
Q#07:
	SELECT D.DEPARTMENT_ID,D.DEPARTMENT_NAME,D.MANAGER_ID,E.FIRST_NAME
epartments D INNER JOIN employees E ON (D.MANAGER_ID = E.EMPLOYEE_ID);
Q#08:
	 SELECT D.DEPARTMENT_NAME,E.FIRST_NAME,L.city FROM departments D JO
IN employees E ON D.MANAGER_ID = E.EMPLOYEE_ID JOIN locations L USING(LOCATION_I
D);
Q#09:	SELECT history.* FROM job_history history JOIN employees E ON hist
ory.EMPLOYEE_ID = E.EMPLOYEE_ID WHERE salary > 10000;
Q#10:	
	SELECT FIRST_NAME,LAST_NAME,HIRE_DATE,SALARY,(DATEDIFF(CURRENT_DAT
E(),HIRE_DATE))/365 FROM departments D JOIN employees E ON D.MANAGER_ID = E.EMPL
OYEE_ID WHERE (DATEDIFF(CURRENT_DATE(),HIRE_DATE))/365 > 15;
Q#11:  
	SELECT DEPARTMENT_NAME,AVG(SALARY),COUNT(COMMISSION_PCT) FROM depa
rtments JOIN employees USING(DEPARTMENT_ID) GROUP BY DEPARTMENT_NAME;
Q#12: 
	SELECT COUNTRY_NAME,CITY,DEPARTMENT_NAME FROM countries JOIN locat
ions USING(COUNTRY_ID) JOIN departments USING(LOCATION_ID);
Q#13: 
	 SELECT DEPARTMENT_NAME, FIRST_NAME,LAST_NAME AS Manager_Name,CITY
FROM departments D  JOIN employees E ON ( D.MANAGER_ID = E.EMPLOYEE_ID)JOIN loca
tions L USING(LOCATION_ID);
Q#14: 
	 SELECT h.* FROM job_history h JOIN employees E  ON (h.EMPLOYEE_ID
= E.EMPLOYEE_ID) WHERE SALARY >=12000;
Q#15: 
	SELECT FIRST_NAME, LAST_NAME AS Employee_name FROM employees JOIN
departments USING(DEPARTMENT_ID) JOIN locations USING(LOCATION_ID) WHERE CITY  =
 'London';
Q#16: 
	SELECT JOB_TITLE,FIRST_NAME,SALARY-MIN_SALARY AS MIN_SALARY FROM e
mployees NATURAL JOIN jobs;
Q#17:
	SELECT JOB_TITLE,AVG(SALARY) FROM employees NATURAL JOIN jobs GROU
P BY JOB_TITLE;
Q#18:	
	SELECT EMPLOYEE_ID,JOB_TITLE,END_DATE-START_DATE DAYS FROM job_his
tory NATURAL JOIN jobs WHERE DEPARTMENT_ID = 90;